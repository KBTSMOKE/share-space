<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>本地共享空间</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* 全局样式 */
    body {
      margin: 0;
      font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(135deg,#667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .container {
      max-width: 1200px;
      width: 100%;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    @media (max-width: 768px) {
      .container { grid-template-columns: 1fr; }
    }
    .section {
      background: rgba(255,255,255,.25);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 8px 32px rgba(31,38,135,.37);
      padding: 25px;
      color: #fff;
    }
    .section h2 {
      margin-top: 0;
      margin-bottom: 20px;
    }
    button {
      background: linear-gradient(45deg,#ff6b6b,#ff8e8e);
      border: none;
      color: #fff;
      padding: 10px 22px;
      border-radius: 50px;
      cursor: pointer;
      margin-top: 10px;
      transition: transform .2s;
    }
    button:hover { transform: scale(1.05); }
    textarea, input[type=text] {
      width: 100%;
      border: none;
      border-radius: 10px;
      padding: 10px;
      resize: vertical;
      outline: none;
    }
    /* 照片墙瀑布流 */
    .photo-gallery {
      column-count: 3;
      column-gap: 10px;
    }
    .photo-item {
      break-inside: avoid;
      margin-bottom: 10px;
      position: relative;
    }
    .photo-item img {
      width: 100%;
      border-radius: 10px;
    }
    .photo-item button {
      position: absolute;
      top: 5px;
      right: 5px;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: rgba(255,0,0,.7);
      color: #fff;
      font-size: 14px;
    }
    /* 待办样式 */
    .todo-item {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .todo-item.completed {
      text-decoration: line-through;
      opacity: .6;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- 照片墙 -->
    <div class="section">
      <h2>📸 本地照片墙</h2>
      <input type="file" id="photoInput" accept="image/*" style="display:none" multiple>
      <button onclick="photoInput.click()">上传照片</button>
      <div class="photo-gallery" id="photoGallery"></div>
    </div>

    <!-- 日记 -->
    <div class="section">
      <h2>📝 本地日记</h2>
      <textarea id="diaryContent" placeholder="写下今天的心情..." rows="4"></textarea>
      <button onclick="saveDiary()">发布日记</button>
      <div id="diaryList"></div>
    </div>

    <!-- 待办 -->
    <div class="section">
      <h2>✅ 本地待办</h2>
      <input type="text" id="todoInput" placeholder="添加待办事项..." />
      <button onclick="addTodo()">添加</button>
      <div id="todoList"></div>
    </div>
  </div>

  <script>
    // 本地存储键
    const KEYS = {
      PHOTOS: 'local_photos',
      DIARIES: 'local_diaries',
      TODOS: 'local_todos'
    };

    // 通用工具
    const load = k => JSON.parse(localStorage.getItem(k) || '[]');
    const save = (k, v) => localStorage.setItem(k, JSON.stringify(v));

    // 照片
    const gallery = document.getElementById('photoGallery');
    function displayPhoto(src) {
      const div = document.createElement('div');
      div.className = 'photo-item';
      div.innerHTML = `
        <img src="${src}">
        <button onclick="deletePhoto('${src}')">×</button>
      `;
      gallery.appendChild(div);
    }
    function deletePhoto(src) {
      if (confirm('删除这张照片？')) {
        let photos = load(KEYS.PHOTOS);
        photos = photos.filter(p => p !== src);
        save(KEYS.PHOTOS, photos);
        gallery.innerHTML = '';
        photos.forEach(displayPhoto);
      }
    }
    document.getElementById('photoInput').addEventListener('change', e => {
      [...e.target.files].forEach(file => {
        const reader = new FileReader();
        reader.onload = ev => {
          const src = ev.target.result;
          let photos = load(KEYS.PHOTOS);
          photos.unshift(src);
          save(KEYS.PHOTOS, photos);
          displayPhoto(src);
        };
        reader.readAsDataURL(file);
      });
    });

    // 日记
    const diaryList = document.getElementById('diaryList');
    function displayDiary(d) {
      const div = document.createElement('div');
      div.style = 'border-left:3px solid #667eea;padding:8px;margin:5px 0;';
      div.innerHTML = `<small>${d.date}</small><br>${d.content}`;
      diaryList.insertBefore(div, diaryList.firstChild);
    }
    function saveDiary() {
      const value = document.getElementById('diaryContent').value.trim();
      if (!value) return alert('写点什么吧！');
      const diaries = load(KEYS.DIARIES);
      diaries.unshift({ content: value, date: new Date().toLocaleString('zh-CN') });
      save(KEYS.DIARIES, diaries);
      displayDiary(diaries[0]);
      document.getElementById('diaryContent').value = '';
    }

    // 待办
    const todoList = document.getElementById('todoList');
    function renderTodos() {
      todoList.innerHTML = '';
      load(KEYS.TODOS).forEach((t, idx) => {
        const div = document.createElement('div');
        div.className = `todo-item ${t.done ? 'completed' : ''}`;
        div.innerHTML = `
          <input type="checkbox" ${t.done ? 'checked' : ''} onchange="toggleTodo(${idx})">
          <span style="flex:1">${t.text}</span>
          <button onclick="deleteTodo(${idx})">×</button>
        `;
        todoList.appendChild(div);
      });
    }
    function addTodo() {
      const value = document.getElementById('todoInput').value.trim();
      if (!value) return alert('输入内容！');
      const todos = load(KEYS.TODOS);
      todos.unshift({ text: value, done: false });
      save(KEYS.TODOS, todos);
      renderTodos();
      document.getElementById('todoInput').value = '';
    }
    function toggleTodo(i) {
      const todos = load(KEYS.TODOS);
      todos[i].done = !todos[i].done;
      save(KEYS.TODOS, todos);
      renderTodos();
    }
    function deleteTodo(i) {
      const todos = load(KEYS.TODOS);
      todos.splice(i, 1);
      save(KEYS.TODOS, todos);
      renderTodos();
    }

    // 初始化
    load(KEYS.PHOTOS).forEach(displayPhoto);
    load(KEYS.DIARIES).forEach(displayDiary);
    renderTodos();
  </script>
</body>
</html>

